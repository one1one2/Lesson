function [F g]=extend_FreRoth(x)

n = length(x);
F = 0;
g = zeros(n,1);

for i = 1:2:n-1
  F = F + (x(i) + x(i+1)*((5 - x(i+1))*x(i+1) - 2) - 13)^2 ...
        + (x(i) + x(i+1)*((1 + x(i+1))*x(i+1) -14) - 29)^2;
  g(i) = g(i) + 2*(x(i) + x(i+1)*((5 - x(i+1))*x(i+1) - 2) - 13)...
        + 2*(x(i) + x(i+1)*((1 + x(i+1))*x(i+1) -14) - 29);
  g(i+1) = g(i+1) + 2*(x(i) + x(i+1)*((5 - x(i+1))*x(i+1) - 2) - 13)...
                    *(-3*x(i+1)^2 + 10*x(i+1) - 2)...
        + 2*(x(i) + x(i+1)*((1 + x(i+1))*x(i+1) -14) - 29)...
         *(3*x(i+1)^2 + 2*x(i+1) - 14);
end 

end 
